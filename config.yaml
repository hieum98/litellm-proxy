# ================================================
# GENERAL SETTINGS
# ================================================
general_settings:
  master_key: os.environ/LITELLM_MASTER_KEY
  # Allow health checks without authentication
  public_routes: ["/health/readiness", "/health/liveness"]

# ================================================
# MODEL CONFIGURATION
# ================================================
model_list:
  # Local Models
  - model_name: Qwen3-0.6B
    litellm_params:
      model: openai/Qwen/Qwen3-0.6B  # Must match the actual model ID from SGLang
      api_base: http://n0165:8000/v1
      api_key: EMPTY
      timeout: 300
      stream_timeout: 600
      max_retries: 2  # Retry mechanism
    model_info:
      id: sglang-qwen-local
      mode: chat

  # OpenAI Models (Primary) - for load balancing
  - model_name: gpt-4o
    litellm_params:
      model: openai/gpt-4o
      api_key: os.environ/OPENAI_API_KEY
      timeout: 120
      stream_timeout: 300
      max_retries: 2  # Retry mechanism
      # rpm: 3500  # Requests per minute limit
    model_info:
      id: openai-gpt4o-primary
      mode: chat

  # OpenAI Models (Backup) - for load balancing
  - model_name: gpt-4o
    litellm_params:
      model: openai/gpt-4o
      api_key: os.environ/OPENAI_API_KEY_BACKUP
      timeout: 120
      max_retries: 2  # Retry mechanism
    model_info:
      id: openai-gpt4o-backup

  # Anthropic Claude - for fallback
  - model_name: claude-3-5-sonnet
    litellm_params:
      model: anthropic/claude-3-5-sonnet-20241022
      api_key: os.environ/ANTHROPIC_API_KEY
      timeout: 120
      max_retries: 2  # Retry mechanism
    model_info:
      id: anthropic-claude-sonnet

  # Google Gemini - for fallback
  - model_name: gemini-2.0-flash
    litellm_params:
      model: gemini/gemini-2.0-flash-exp
      api_key: os.environ/GOOGLE_API_KEY
      timeout: 60
      max_retries: 2  # Retry mechanism
    model_info:
      id: google-gemini-flash

  # Embedding Models
  - model_name: text-embedding-3-small
    litellm_params:
      model: openai/text-embedding-3-small
      api_key: os.environ/OPENAI_API_KEY
      max_retries: 2  # Retry mechanism
    model_info:
      id: openai-embedding-small
      mode: embedding

# ================================================
# LITELLM SETTINGS - Simplified for core features
# ================================================
litellm_settings:
  # Logging (minimal)
  set_verbose: false
  json_logs: true
  
  # Request timeout
  request_timeout: 600
  
  # Drop unsupported params for different providers
  drop_params: true
  
  # CACHING CONFIGURATION
  cache: true


# ================================================
# ROUTER SETTINGS - Load Balancing & Retry Mechanisms
# ================================================
router_settings:
  # LOAD BALANCING: Routing strategy
  # Options: simple-shuffle, least-busy, usage-based-routing, latency-based-routing
  routing_strategy: simple-shuffle
  
  # RETRY MECHANISMS: Retry configuration
  num_retries: 3
  retry_after: 5  # Wait 5 seconds before retry
  timeout: 120
  
  # RETRY MECHANISMS: Deployment health management
  allowed_fails: 3
  cooldown_time: 30
  
  # Enable pre-call checks (context window, region, etc.)
  enable_pre_call_check: true
  
  # RETRY MECHANISMS: Error-specific retry policies
  retry_policy:
    TimeoutErrorRetries: 3
    RateLimitErrorRetries: 3
    InternalServerErrorRetries: 2
    ServiceUnavailableErrorRetries: 2
    BadRequestErrorRetries: 0
    AuthenticationErrorRetries: 0
    PermissionDeniedErrorRetries: 0
    ContentPolicyViolationErrorRetries: 1
    ContextWindowExceededErrorRetries: 0
  
  # RETRY MECHANISMS: Error-specific cooldown policies
  allowed_fails_policy:
    RateLimitErrorAllowedFails: 100
    TimeoutErrorAllowedFails: 50
    InternalServerErrorAllowedFails: 50
    ContentPolicyViolationErrorAllowedFails: 1000
  
  # LOAD BALANCING: Fallback configuration (fallback to different models)
  fallbacks:
    - gpt-4o:
      - claude-3-5-sonnet
    - claude-3-5-sonnet:
      - gemini-2.0-flash
  
  # LOAD BALANCING: Context window fallbacks (automatic upgrade for long contexts)
  context_window_fallbacks:
    - gemini-2.0-flash: gpt-4o
    - claude-3-5-sonnet: gpt-4o

# ================================================
# CACHE PARAMS - Redis Configuration for Caching
# ================================================
cache_params:
  type: redis
  host: os.environ/REDIS_HOST
  port: os.environ/REDIS_PORT
  # password: os.environ/REDIS_PASSWORD  # Disabled - no password
  ssl: false
  ttl: 36000  # Cache for 10 hours
  namespace: "litellm"
  supported_call_types:
    - completion
    - acompletion
    - embedding
    - aembedding
